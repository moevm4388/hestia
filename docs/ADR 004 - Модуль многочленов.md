**Автор:** Шелепугин Иван Михайлович  
**Рецензент:** Шарапов Даниил Романович  
**Дата:** 11 ноября 2025

---

ADR (Architecture Decision Record) по модулю рациональных чисел.

## Хранение данных

Существует два способа хранения многочлена:

1. Массив
2. Связный список

Преимущество второго состоит в том, что в памяти хранятся только необходимые данные. Нулевые коэффициенты можно опустить, тем самым экономится место. Однако

- Большинство алгоритмов работают проще и эффективнее, если использовать массив.
- В современных компьютерах память, зачастую, не является проблемой.

Преимущество хранения данных в массиве состоит, прежде всего, в удобстве.
Например, индекс элемента — это степень одночлена, поэтому получение
коэффициента соответствующей степени имеет сложность O(1). Если
проанализировать арифметические операции, то можно также заметить, что
производить их с массивом удобнее, чем со связным списком.

Предлагается хранить многочлен в массиве рациональных коэффициентов, от
свободного члена до старшего коэффициента. Например

```py
[2, 0, 0, 3, 1]
```

это представление для многочлена

```
x⁴ + 3x³ + 2
```

## Парсинг из строки

Парсер многочленов можно реализовать при помощи регулярных выражений или машины
состояний с посимвольным анализом строки. Рекомендуется принимать на вход
каноническую форму многочлена, в этом случае можно для удобства выделить логику
парсинга одночлена.

Парсинг одночленов можно описать следующими шагами:

1.  Обрезка строки.
2.  Считывание символов **в буфер 1**, пока текущий символ — цифра, `/`
    (разделитель дроби) или `*` (знак умножения).
    - Если знак умножения повторяется: ошибка.
    - Если встретился посторонний символ: ошибка.
    - Если встретился символ `x` (переменная многочлена): переход к шагу 3.
3.  Считывание символов до `^` (знак возведения в степень), пока текущий символ
    — пробел.
    - Если встретился посторонний символ: ошибка.
4.  Считывание символов **в буфер 2**, пока текущий символ — цифра.
    - Если встретился пробел: конец.
    - Если встретился посторонний символ: ошибка.

Результат:

- В буфере 1 хранится строковое представление коэффициента.
- В буфере 2 хранится строковое представление степени.

Парсинг многочленов, в свою очередь, представляет собой следующий алгоритм:

1.  Обрезка строки
2.  Считывание **в буфер 1** символов до знака `+` или `-`.
    - Если встретился посторонний символ (не пробел): ошибка.
3.  Знак сохраняется для следующего одночлена.
4.  В буфере 1 содержится строковое представление одночлена, необходимо
    применить алгоритм для парсинга, описанный выше, и сохранить его.
5.  Повторять шаги 2-4, пока в строке есть символы. Оставшиеся символы также
    парсятся как одночлен.

## Операции

Операции представлены в
[таблице](https://docs.google.com/document/d/1Dv_6AIhxg_3ezu6VMcEnMpyfRzgym9l8PmE4ULGfjgM)
с описанием модулей (стр. 3).
